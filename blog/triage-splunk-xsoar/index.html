<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="robots" content="index, follow">
    <meta name="description" content="Automated malware analysis with Hatching Triage, the high-volume sandbox solution for SOCs, CERTs, SOARs, and MSSPs.">
    <meta name="keywords" content="Hatching, Hatching Triage, Sandbox, Malware Analysis, Automated Malware Analysis">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="revisit-after" content="3 days">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@hatching_io">
    <meta name="twitter:title" content="Hatching - Automated malware analysis solutions">
    <meta property="og:title" content="Hatching - Automated malware analysis solutions">
    <meta property="og:description" content="Automated malware analysis with Hatching Triage, the high-volume sandbox solution for SOCs, CERTs, SOARs, and MSSPs.">
    <meta property="og:url" content="https://www.hatching.io">
    <link rel="manifest" href="/static/manifest.json">
    
      <meta property="og:image" content="https://www.hatching.io/static/images/backgrounds/resized-38.jpg">
      <meta name="twitter:image" content="https://www.hatching.io/static/images/backgrounds/resized-38.jpg">
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123677703-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123677703-1');
    </script>
    <link rel="stylesheet" href="https://hatching.io/static/css/index.css?1726233262">
    <link rel="icon" type="image/png" sizes="32x32" href="https://hatching.io/static/images/favicon-32x32.png?v=21">
    <link rel="icon" type="image/png" sizes="16x16" href="https://hatching.io/static/images/favicon-16x16.png?v=21">
    <title>Triage Integration with Splunk and Cortex XSOAR</title>
  </head>
  <body>
<nav class="site-menu">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/about/">About</a></li>
    <li><a href="/triage/">Triage</a></li>
    <li><a class="active" href="/blog/">Blog</a></li>
    <li><a  href="https://boards.greenhouse.io/recordedfuture" rel="nofollow">Jobs</a></li>
    <li><a href="https://go.recordedfuture.com/enterprise-sandbox-contact-us" target="_blank">Contact</a></li>
  </ul>
</nav>
<header class="site-nav headroom theme-light">
  <div class="logo">
    <a href="/">
      <img width="210px" src="https://hatching.io/static/images/rf-hatching-black.svg" width="164">
    </a>
  </div>
  <div>
    <a href="#" class="toggle-menu">
      Menu
      <span></span>
      <span></span>
      <span></span>
    </a>
  </div>
</header>


<section class="scheme-1 view-context blog-fold blog-article-head" id="fold" data-keep="true">
  <div class="view-context__body">
    <div>
      <div>
        
        <h2>Triage Integration with Splunk and Cortex XSOAR</h2>
      </div>
      <ul>
        <li>Share this:</li>
        <li class="social">
          <a href="https://twitter.com/hatching_io" target="_blank">
            <i class="icon-twitter"></i>
          </a>
          <a href="https://www.linkedin.com/company/hatching" target="_blank">
            <i class="icon-linkedin"></i>
          </a>
          <a href="https://www.github.com/hatching" target="_blank">
            <i class="icon-github"></i>
          </a>
        </li>
      </ul>
    </div>
    <div>
      <h1>Blog.</h1>
    </div>
  </div>
  <div class="background-graphic">
    
      <div class="image" style="background-image: url('/static/images/backgrounds/resized-38.jpg');"></div>
    
  </div>
</section>

<article class="view-context blog-article">
  <header class="blog-article-meta">
    <div class="blog-article-general">
      <p><time datetime="2020-12-02T00:00:00Z">2020-12-02</time></p>
        
          <ul class="blog-article-tags">
            <li><p><a href="/blog/#category=triage">triage</a></p>
          </ul>
        
    </div>
    <div class="blog-article-author">
      <div class="avatar">
        <img src="/static/images/avatars/pete.svg" />
      </div>
      <div>
        <h5>Written by <br />Team</h5>
      </div>
    </div>
  </header>
  <section class="blog-article-body">
    
      <p>We are always looking for new ways to make the information generated by Triage more accessible and useful to organisations. Triage is likely only one element of a much larger security infrastructure, and we want it to be easy to incorporate sandbox reports into existing workflows. As a major step towards this, we are pleased to share that Triage integration is now available for the Security Orchestration, Automation and Response (SOAR) platforms <a href="https://www.splunk.com/en_us/software/splunk-security-orchestration-and-automation.html">Splunk Phantom</a> and <a href="https://www.paloaltonetworks.com/cortex/xsoar">Cortex XSOAR</a>.</p>
<p>In this blogpost we will give a quick guide to getting started with these integrations, and show how to add Triage as a data source to these platforms.</p>
<p>You can find more information about Triage for commercial usage <a href="https://hatching.io/triage/">on our website</a>.</p>
<p><strong>Jump to section:</strong></p>
<ul>
<li><a href="#splunk">Splunk Phantom</a></li>
<li><a href="#xsoar">Cortex XSOAR</a></li>
</ul>
<p>We hope that the content below is enough to get you started with these new integrations. As usual if you have any questions or feedback feel free to get in touch and we&rsquo;ll do our best to help.</p>
<hr>
<h2 id="splunk">Splunk Phantom</h2>
<h3 id="installing-the-application">Installing the Application</h3>
<p>Triage can be installed as an App in any Splunk Phantom instance. After logging into the platform, go to the main dashboard and select <code>Apps</code> from the dropdown menu.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_1.png"><figcaption>
      <h4>Select &#39;Apps&#39; from the menu</h4>
    </figcaption>
</figure>

<p>At the top right of the Apps window select <code>Install App</code>.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_2.png"><figcaption>
      <h4>Select &#39;Install App&#39;</h4>
    </figcaption>
</figure>

<p>Select the Triage App tarball we will provide to commercial users or drag and drop it into the window, and select <code>Install</code>.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_3.png"><figcaption>
      <h4>Choose the installation file and click &#39;Install&#39;</h4>
    </figcaption>
</figure>

<p>Once the installation has completed, there are a few things to configure before the App is ready to use.</p>
<h3 id="configuring-an-asset">Configuring an Asset</h3>
<p>Once installed you will see some basic information which can be set however you want. The main ones we are interested in are under the <code>Asset Settings</code> tab - here is where we tell the App how to talk to the Triage server.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_4.png"><figcaption>
      <h4>Go to &#39;Asset Settings&#39; to configure the App</h4>
    </figcaption>
</figure>

<p>There are 3 things here you need to configure:</p>
<ol>
<li>
<p><strong>Server IP/Hostname</strong>
The hostname of the Triage instance you use. If you&rsquo;re setting up Splunk with a private cloud instance that would be <code>private.tria.ge</code>. For the public cloud this would be <code>api.tria.ge</code>.</p>
</li>
<li>
<p><strong>API Path</strong>
The path to the root of the API endpoint. For private clouse instances this would be <code>/api/v0/</code>. For the public cloud this would be just <code>/v0/</code>.</p>
</li>
<li>
<p><strong>API key</strong>
Here is where you enter the API key from the Triage account you want to connect. This can be found on your account page in the web UI.</p>
</li>
</ol>
<figure><img src="../../static/images/blog/splunk-xsoar/api_key.png">
</figure>

<p>That&rsquo;s it! Triage is now installed and ready to use as a data source in Playbooks.</p>
<h3 id="using-triage-in-a-playbook">Using Triage in a Playbook</h3>
<p>Currently the Triage App support 2 investigative actions:</p>
<ul>
<li>Detonate file</li>
<li>Detonate URL</li>
</ul>
<p>To add an action to a Playbook, select the green connector on the start node.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_5.png">
</figure>

<p>Press &lsquo;Action&rsquo; in the menu on the left and select &lsquo;Hatching Triage&rsquo;.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_6.png">
</figure>

<p>You can now select the preferred action and what information is passed into the Playbook. All the information from the Triage report is available to choose from, but the most important data is generally found in the summary section.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_7.png">
</figure>

<h3 id="selecting-an-analysis-profile">Selecting an Analysis Profile</h3>
<p>Triage Profiles can be used to customise various parameters of the analysis, such as internet connectivity or the maximum time the sample will be run for. They can be created and modified through the Profiles page when logged into Triage (only available to Researcher accounts on the public server).</p>
<p>By default the file or URL action will run with the standard &lsquo;Automatic&rsquo; profile, but this can be configured in the settings for the Action in a playbook.</p>
<p>For example to choose a profile with the name <code>Long</code> defined on Triage as follows:</p>
<figure><img src="../../static/images/blog/splunk-xsoar/profiles.png">
</figure>

<p>Simply add that profile name into the <code>profile_id</code> field of the Detonate File or Detonate URL action in Splunk.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/splunk_8.png">
</figure>

<h2 id="xsoar">Cortex XSOAR by Palo-Alto Networks</h2>
<p>Thanks to the team at Palo-Alto Networks there is now an integration for Hatching Triage available through the Marketplace of their Cortex XSOAR platform. It can be downloaded free of charge and configured to pull data from a Triage instance - all you need is a valid Triage API key, available to public Researcher accounts and Private Cloud customers.</p>
<p>The integration supports all of the endpoints available through the Triage API, providing full access to submit samples and fetch results, as well as management tasks like adding users or managing profiles. The commands can be run manually through the XSOAR Playground, e.g. <code>!triage-query-samples</code>, or in Playbooks for automated analysis tasks.</p>
<p>The sections below should get you started with deploying the new integration.</p>
<h3 id="installing-the-triage-integration">Installing the Triage Integration</h3>
<p>The first step is to download and install the package for your XSOAR deployment. Just go to the Marketplace, search for &lsquo;Hatching Triage&rsquo;, and install the integration shown.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/xsoar/triage_marketplace.png">
</figure>

<p>Once the package is installed, there are a few settings to configure before the integration can be used. Go to Settings in the menu on the left then <code>Integrations</code> -&gt; <code>Server &amp; Services</code>. Find the Hatching Triage integration and click <code>Add instance</code> to open the configuration dialog.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/xsoar/triage_settings.png">
</figure>

<p>The <code>base_url</code> field points to the API endpoint and by default is set to the public tria.ge server. For Private Cloud users this should be set to <code>https://private.tria.ge/api/v0/</code>.</p>
<p>Paste your Triage API key into the API Key field. This can be found on your <a href="https://tria.ge/account">profile page</a></p>
<p>Click <code>Done</code> and the integration is now ready to use! Commands supported by it begin with the word <code>triage</code> - a basic summary of these is shown below.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Command</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>triage-query-samples</code></td>
          <td style="text-align: left">List all samples visible using the provided API key</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-submit-sample</code></td>
          <td style="text-align: left">Submits a file or URL for analysis</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-sample</code></td>
          <td style="text-align: left">Fetch basic information about an analysis</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-sample-summary</code></td>
          <td style="text-align: left">Fetch a summary report for the sample ID provided</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-delete-sample</code></td>
          <td style="text-align: left">Delete an analysis</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-set-sample-profile</code></td>
          <td style="text-align: left">When a sample is in the static_analysis status, a profile should be selected in order to continue.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-static-report</code></td>
          <td style="text-align: left">Get the static analysis report for a sample</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-report-triage</code></td>
          <td style="text-align: left">Fetch the full Triage report for a single behavioural analysis task</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-kernel-monitor</code></td>
          <td style="text-align: left">Fetches the onemon.json file which logs all VM activity during analysis</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-pcap</code></td>
          <td style="text-align: left">Fetch the PCAP of an analysis for manual investigation</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-dumped-file</code></td>
          <td style="text-align: left">Fetch files dumped during behavioural analysis. The names can be found under the &ldquo;dumped&rdquo; section of the Triage report</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-users</code></td>
          <td style="text-align: left">Return all users within the company as a paginated list. Returns a single user if a userID is provided</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-create-user</code></td>
          <td style="text-align: left">Creates a new user and returns it&rsquo;s details. The user will become a member of the company the requesting user is a member of.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-delete-user</code></td>
          <td style="text-align: left">Delete a user and all associated data, invalidating any sessions and removing their API keys. Any samples submitted by this user are kept.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-create-api-key</code></td>
          <td style="text-align: left">Creates a new key which can be used to make API requests on behalf of the specified user. The user should have been granted the <code>access_api</code> permission beforehand</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-api-key</code></td>
          <td style="text-align: left">Lists all API keys that the user has.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-delete-api-key</code></td>
          <td style="text-align: left">Delete the specified API key from the user&rsquo;s account.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-get-profiles</code></td>
          <td style="text-align: left">List all profiles accessible with the provided API key.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-create-profile</code></td>
          <td style="text-align: left">Create a new analysis profile with the defined settings.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-update-profile</code></td>
          <td style="text-align: left">Update the profile with the specified ID or name. The stored profile is overwritten, so it is important that the submitted profile has all fields, with the exception of the ID</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>triage-delete-profile</code></td>
          <td style="text-align: left">Delete the specified analysis profile.</td>
      </tr>
  </tbody>
</table>
<h3 id="using-triage-in-xsoar-playbooks">Using Triage in XSOAR Playbooks</h3>
<p>The Triage commands shown above can all be used in Playbooks when creating automated workflows once the module is installed and configured.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/xsoar/triage_playbook.png"><figcaption>
      <h4>Example Playbook for submitting a file to Triage</h4>
    </figcaption>
</figure>

<p>To add a node, simply create a new task and use the dropdown list to choose the relevant command. The dialog box will then update to show the fields which are available for this API request. For example, when submitting a sample using <code>triage-submit-sample</code> the configuration resembles the screenshot below.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/xsoar/triage_submit_sample.png">
</figure>

<p>The outputs which are then available for further processing can be seen in the <code>Outputs</code> tab of the configuration dialog box. For example to fetch the ID of the new analysis use the value <code>Triage.submissions.status</code>.</p>
<figure><img src="../../static/images/blog/splunk-xsoar/xsoar/triage_submit_outputs.png">
</figure>


    
  </section>
</article>


<section class="view-context blog-recommendations">
  <article class="view-context__body">
    <h2>You may also like:</h2>
    
    <ul>
      
        <li>
          <h3>Ep. 147: Triage Thursday</h3>
          <br>
          <a class="button button-variant-3" href="https://hatching.io/blog/tt-2024-09-05/">Read</a>
        </li>
      
        <li>
          <h3>Ep. 142: Triage Thursday</h3>
          <br>
          <a class="button button-variant-3" href="https://hatching.io/blog/tt-2024-08-01/">Read</a>
        </li>
      
        <li>
          <h3>Ep. 145: Triage Thursday</h3>
          <br>
          <a class="button button-variant-3" href="https://hatching.io/blog/tt-2024-08-22/">Read</a>
        </li>
      
        <li>
          <h3>Custom Archive Passwords, Dridex Config Extractor and Family Updates</h3>
          <br>
          <a class="button button-variant-3" href="https://hatching.io/blog/tt-2020-09-24/">Read</a>
        </li>
      
    </ul>
  </article>
</section>
    <footer class="scheme-4 view-context footer" id="contact">
      <article class="view-context__body">
        <h2>Want to know more?<br />Get in touch!</h2>
        <a class="button button-variant-1" target="_blank" href="https://go.recordedfuture.com/enterprise-sandbox-contact-us" i>Contact us</a>
        <ul>
          <li>
            <ul>
              <li class="logo"><img src="https://hatching.io/static/images/rf-hatching-white.svg" alt="hatching"/></li>
              <li class="social">
                <a href="https://twitter.com/hatching_io" target="_blank">
                  <i class="icon-twitter"></i>
                </a>
                <a href="https://www.linkedin.com/company/hatching" target="_blank">
                  <i class="icon-linkedin"></i>
                </a>
                <a href="https://www.github.com/hatching" target="_blank">
                  <i class="icon-github"></i>
                </a>
              </li>
            </ul>
          </li>
          <li>
            Hatching International B.V.<br />
            The Netherlands<br/>
            <br />
            Email us: <a href="mailto:info@hatching.io">info@hatching.io</a>
          </li>
          <li>
            IBAN: NL52 INGB 0006 9672 73<br />
            BIC: INGBNL2A<br />
            ING Groep N.V.<br />
            Amsterdam-Zuidoost<br />
            <br />
            REG: 64146707<br />
            VAT: NL855541891B01
          </li>
        </ul>
      </article>
      <div class="form hidden">
        <div class="form-logo">
          <img src="https://hatching.io/static/images/rf-hatching-white.svg" alt="Hatching"/>
        </div>
        <a href="#" class="form-close" title="Close (or press esc)"></a>

        <div class="container">
          <h1>Contact us</h1>
          <h3>Feel free to inquire or request about our services.</h3>
          <form>
            <fieldset>
              <div class="field">
                <div class="input is-required">
                  <input id="form-name" name="name" placeholder="Name" />
                </div>
              </div>
              <div class="field">
                <div class="input is-required">
                  <input id="form-email" name="email" placeholder="Email" />
                </div>
              </div>
              <div class="field">
                <div class="input">
                  <input id="form-phone" name="phone" placeholder="Phone number" />
                </div>
              </div>
              <div class="field">
                <div class="input">
                  <input id="form-company" name="company" placeholder="Company" />
                </div>
              </div>
            </fieldset>
            <fieldset>
              <div class="input required">
                <textarea id="form-message" name="message" placeholder="Write a message"></textarea>
              </div>
              <div class="button-group">
                <button type="reset" class="button button-variant-2 button-transparent">Reset</button>
                <button type="submit" class="button button-variant-1">Send</button>
              </div>
            </fieldset>
          </form>
        </div>

      </div>
    </footer>
    <script src="https://hatching.io/static/js/hatching.js?1726233262"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
          if(window.main && window.main instanceof Function) {
            window.main();
          }
          initForm();

          
          
        });
    </script>
  </body>
</html>
